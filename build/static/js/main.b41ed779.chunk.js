(this["webpackJsonpmini-app"]=this["webpackJsonpmini-app"]||[]).push([[0],{154:function(t,e,n){"use strict";n.r(e);var i=n(0),s=n(21),r=n.n(s),a=n(14),c=n.n(a),o=n(16),u=n(24),l=n(20),h=n(15),d=n.n(h),j=n(10),m=(n(152),n(33)),p=n(34),f=n(37),b=n(36),O={bellHighTone:"/audio/bell-high.mp3",bellLowTone:"/audio/bell-high.mp3"},x=n(25),_=n.n(x),v=n(4),g=6e4,T=function(t){var e=function(t){return(t<10?"0":"")+t};return Object(v.jsxs)("div",{className:_.a.timeViewWrapper,children:[Object(v.jsx)("h2",{className:_.a.textStyle,children:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c"}),Object(v.jsx)("h1",{className:_.a.timer,children:function(){var n=(t.time-t.time%g)/g,i=Math.floor((t.time-n*g)/1e3);return e(n)+":"+e(i)}()})]})},y=n(35),k=n.n(y),w=function(t){var e=t.user;return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(j.f,{title:e.first_name,children:Object(v.jsx)(j.c,{before:e.photo_200?Object(v.jsx)(j.a,{src:e.photo_200}):null,description:e.city&&e.city.title?e.city.title:"",children:"".concat(e.first_name," ").concat(e.last_name)})})})},S=n(155),C=n(156),L=n(157),A=n(19),I=n.n(A),N=function(t){var e=t.isOn,n=t.toggleTimer,i=t.resetTimer,s=t.isResetBtnVisible;I.a.controlButton;return Object(v.jsx)(j.f,{title:"controls",children:Object(v.jsxs)(j.e,{className:I.a.flexCenter,children:[Object(v.jsx)("div",{className:I.a.controlButton,onClick:n,children:e?Object(v.jsx)(S.a,{}):Object(v.jsx)(C.a,{})}),s&&Object(v.jsx)("div",{className:I.a.controlButton,onClick:i,children:Object(v.jsx)(L.a,{})})]})})},V=6e4,W=6e5,B=function(t){Object(f.a)(n,t);var e=Object(b.a)(n);function n(t){var i;return Object(m.a)(this,n),(i=e.call(this,t)).state=i.getInitState(),i}return Object(p.a)(n,[{key:"getInitState",value:function(){return{duration:W,isOn:!1,start:0,timeLeft:W,deadLine:Date.now()+this.props.duration,startSound:new Audio(O.bellHighTone),stopSound:new Audio(O.bellLowTone),adjustTimer:!1}}},{key:"toggleTimer",value:function(){this.state.isOn?this.stopTimer():this.startTimer()}},{key:"startTimer",value:function(){var t=this;this.setState({isOn:!0,timeLeft:this.state.duration,start:Date.now(),deadLine:Date.now()+this.state.duration}),this.state.startSound.play(),this.timer=setInterval((function(){t.state.timeLeft>0?t.setState({timeLeft:Math.max(t.state.deadLine-Date.now(),0)}):(t.state.stopSound.play(),t.stopTimer())}),1)}},{key:"stopTimer",value:function(){this.setState({isOn:!1}),clearInterval(this.timer)}},{key:"resetTimer",value:function(){this.setState({timeLeft:this.state.duration,isOn:!1,deadLine:Date.now()+this.state.duration})}},{key:"toggleAdjust",value:function(){this.state.isOn||this.setState({adjustTimer:!this.state.adjustTimer})}},{key:"render",value:function(){var t=this,e=!this.state.isOn&&this.state.timeLeft!==this.state.duration;return Object(v.jsxs)(j.g,{id:this.props.id,children:[Object(v.jsx)(j.h,{children:"Dhyan Timer"}),this.props.fetchedUser&&Object(v.jsx)(w,{user:this.props.fetchedUser}),Object(v.jsx)(j.e,{onClick:function(e){return t.toggleAdjust()},children:Object(v.jsx)(T,{time:this.state.timeLeft})}),this.state.adjustTimer&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(j.j,{before:Object(v.jsx)(j.d,{mode:"primary",size:"m",children:1}),after:Object(v.jsx)(j.d,{mode:"primary",size:"m",children:1e3})}),Object(v.jsx)(j.k,{min:1,max:1e3,step:1,value:this.state.duration/V,onChange:function(e){t.setState({timeLeft:e*V,duration:e*V})}}),Object(v.jsx)(j.e,{className:k.a.flexCenter,children:Object(v.jsx)(j.b,{appearance:"overlay",size:"l",onClick:function(e){return t.toggleAdjust()},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},"saveDuration")})]}),!this.state.adjustTimer&&Object(v.jsx)(N,{isOn:this.state.isOn,toggleTimer:this.toggleTimer.bind(this),resetTimer:this.resetTimer.bind(this),isResetBtnVisible:e})]})}}]),n}(i.Component),D=function(){var t=Object(i.useState)("bright_light"),e=Object(l.a)(t,2),n=(e[0],e[1]),s=Object(i.useState)("home"),r=Object(l.a)(s,2),a=r[0],h=(r[1],Object(i.useState)(null)),m=Object(l.a)(h,2),p=m[0],f=m[1],b=Object(i.useState)(Object(v.jsx)(j.i,{size:"large"})),O=Object(l.a)(b,2),x=O[0],_=O[1];Object(i.useEffect)((function(){function t(){return(t=Object(u.a)(d.a.mark((function t(){var e;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.send("VKWebAppGetUserInfo");case 2:return e=t.sent,f(e),_(null),t.abrupt("return",e);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}c.a.subscribe((function(t){var e=t.detail,i=e.type,s=e.data;"VKWebAppUpdateConfig"===i&&(n(s.scheme),c.a.send("VKWebAppGetAuthToken",{app_id:Number(s.app_id),scope:"friends,photos"}).then((function(t){setToken(t.access_token),g()})).catch((function(t){console.log("error: ".concat(t," "))})))})),function(){return t.apply(this,arguments)}().then((function(t){g(t.id).then((function(e){e||T(t)}))}))}),[]);var g=function(){var t=Object(u.a)(d.a.mark((function t(e){var n,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://d5dkgim47m3sjaq4k4s3.apigw.yandexcloud.net/user?id=".concat(e));case 2:if(!(n=t.sent).ok){t.next=10;break}return t.next=6,n.json();case 6:return i=t.sent,t.abrupt("return",i[0]);case 10:return alert("\u041e\u0448\u0438\u0431\u043a\u0430 HTTP: "+n.status),t.abrupt("return",null);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),T=function(){var t=Object(u.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://d5dkgim47m3sjaq4k4s3.apigw.yandexcloud.net/user",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({$id:e.id,$name:e.first_name+" "+e.last_name})});case 2:if(!(n=t.sent).ok){t.next=10;break}return t.next=6,n.json();case 6:t.sent,console.log(JSON.stringify),t.next=11;break;case 10:alert("\u041e\u0448\u0438\u0431\u043a\u0430 HTTP: "+n.status);case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(v.jsx)(j.l,{activePanel:a,popout:x,children:Object(v.jsx)(B,{id:"home",fetchedUser:p,showInput:function(){setState(Object(o.a)(Object(o.a)({},initialState),{},{activeModal:"timeInputTest"}))},go:function(t){setState(Object(o.a)(Object(o.a)({},state),{},{activePanel:t.currentTarget.dataset.to}))}})})};c.a.send("VKWebAppInit"),r.a.render(Object(v.jsx)(D,{}),document.getElementById("root"))},19:function(t,e,n){t.exports={flexCenter:"control-btns_flexCenter__ICrgy",controlButton:"control-btns_controlButton__1f4hn"}},25:function(t,e,n){t.exports={timeViewWrapper:"timer-view_timeViewWrapper__2DVe6",timer:"timer-view_timer__2_NkA",textStyle:"timer-view_textStyle__1Wj6J"}},35:function(t,e,n){t.exports={flexCenter:"home_flexCenter__1EYnj",width100:"home_width100__2Wl4r",textCenter:"home_textCenter__2mGUY",sliderScale:"home_sliderScale__2WAiT",sliderMinTime:"home_sliderMinTime__fCnIf",sliderMaxTime:"home_sliderMaxTime__3lRxn"}}},[[154,1,2]]]);
//# sourceMappingURL=main.b41ed779.chunk.js.map